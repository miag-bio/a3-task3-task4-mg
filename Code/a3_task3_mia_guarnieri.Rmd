---
title: "a3_task3_mia_guarnieri"
author: "Mia Guarnieri"
date: "10/29/2021"
output: 
  html_document: 
    number_sections: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# Task 3

## Overview
This code wrangles, analyzes, and visualizes data about the size frequency distribution of red and purple sea urchins recorded by Santa Barbara Coastal Long Term Ecological Research program divers at five long-term kelp removal experiment sites. Shell diameter (size) was measured in centimeters.

**Data citation:** Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b. 

## Setup

```{r}
#attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)

#read in the data
urchins <- read.csv(here("Data", "urchins.csv"))

#calling up the dtaframe for reference
head(urchins)
```


## Size comparisons of red and purple urchins

### Histogram

This faceted histogram compares the distribution of sizes between purple and red urchins across both treatments. 

```{r}
ggplot(data = urchins, aes(x = SIZE)) + #designating the data and x variable
  geom_histogram(bins = 10, color = "gray0", aes(fill = COMMON_NAME)) + #selecting a histogram, designating bin number, color coding by species, and adding outlines
  scale_fill_manual(values = c("darkviolet", "firebrick3")) + #designating color coding
  facet_wrap(~COMMON_NAME) + #splitting the graph by common name
  labs(x = "Size (cm)", #labeling axes
       y = "Count")
```

**Figure 1**: A histogram of purple and red sea urchin sizes, measured in centimeters.

### Data table of urchin statistics

The following data table presents summary statistics for red and purple urchin samples, including mean, median, standard deviation, and sample size.

```{r}
#getting the summary statistics
urchin_stats <- urchins %>% #start with the urchins data
  group_by(COMMON_NAME) %>% #group our table by urchin species
  summarize(mean = mean(SIZE), #create a column for the mean of urchin sizes
            median = median(SIZE), #create a column for the median of urchin sizes
            sd = sd(SIZE), #create a column for the standard deviation of urchin sizes
            n = n()) #create a column for the sample size of urchin sizes

#creating a visually pleasing table
urchin_stats_table <- urchin_stats %>% 
  kable(digits = c(1, 1, 1, 1, 5), #setting the number of digits for each column; similar to `round()`)
        col.names = c("Species", "Mean (cm)", "Median (cm)", "Standard Deviation (cm)", "Sample Size"), #naming columns
        caption = "<center><strong>Urchin size summary statistics</strong></center>", #giving the table a bold, centered title
        escape = FALSE, 
        align = "lcccc") %>%  #aligning the values centrally except for the species column (left aligned)
  kable_styling(full_width = FALSE, position = "center") %>% #setting it to not take up the full page width and be center aligned
  footnote(general = "Summary statistics for the diameter (size) of purple and red sea urchins recorded by Santa Barbara Coastal Long Term Ecological Research program divers at five long-term kelp removal experiment sites.", #adding a table caption with the `footnote()` function
           general_title = "Table 1:", #titling the table caption
           title_format = "bold", #bolding the title
           footnote_as_chunk = TRUE) #showing the title and caption as one chunk of text

urchin_stats_table #calling up the table for reference
```

### Takeaways

Mean size for purple urchins was `r round(urchin_stats$mean[1], 1)` cm, which is `r round(urchin_stats$mean[2] - urchin_stats$mean[1], 1)` cm smaller (`r round(((urchin_stats$mean[2] - urchin_stats$mean[1])/mean(urchin_stats$mean))*100, 1)`% smaller) than the mean size for red urchins. Purple urchin data also had a smaller spread around the mean value, based on the histogram visualizations and the lower standard deviation (sd = `r round(urchin_stats$sd[1], 1)` cm) than the red urchin data (sd = `r round(urchin_stats$sd[2], 1)` cm).


## Exploring purple urchin counts by site and year

### 



